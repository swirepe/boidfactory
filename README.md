# Boidfactory

Single‑file Boids simulations generated by scripts and a Go dual‑mode generator. Output is a self‑contained HTML file with a canvas simulation, rich controls, and shareable URL parameters. You can also run a local server that serves deterministic simulations from a URL seed.

## Features
- Boids with alignment, cohesion, separation; optional wrapping or soft walls.
- Flow field influence with visualization overlay (angle/curl/turbulence modes).
- Flow coloring and glow: color and bloom influenced by local flow; glow uses nearest overlay arrow hue.
- Quadtree spatial partitioning with visualization (enabled by default).
- Vision radius visualization (off | one | all).
- Live count changes: the Count slider resizes the simulation without reload.
- Multiple shapes and blends (trail/triangle/dot/comet/ring; lighter/screen/etc.).
- Spawn patterns (random/ring/center/edge/grid).
- Per‑simulation click/drag behavior variety (shockwave/gravity/spin/scatter; pull/push/spin/flow).
- Mobile‑friendly UI with an overlay panel and shareable URLs.

## Quick Start

Build and run the Go generator (requires Go 1.22+):

- Build: `go build ./cmd/boids`
- Generate files: `./boids -count 1`
  - Outputs to `runs/boids-YYYYMMDD_HHMMSS_singlefile/boids-dod-quadtree-impl.html`
- Serve locally: `./boids -serve -addr :8080`
  - Open `http://localhost:8080/demo`

Optional viewer index for a folder:
- `python3 build-link-viewer.sh runs/boids-YYYYMMDD_*`

Shell pipelines (need local `ollama` and optional `fzf`):
- One run: `./boidfactory.sh --model qwen3-coder:latest`
- Many runs: `./boidfactory.sh --times 8 --parallel 4`
- Interactive model: `./boidfactory.sh --model-select`

## Controls (gear icon)
- Simulation: Count, Vision, Separation Dist, Max/Min Speed, Max Force, weights.
- Visual: Line Width, Trail Alpha, Background Gradient + hue shifts, Blend, Shape, Spawn.
- Overlays: Quadtree (viz), Flow field (enable), Flow viz (overlay), Vision viz (off|one|all).
- Flow: Mode (angle|curl|turbulence), Speed/Scale/Amplitude, Amp Variation, Anisotropy (Y), Octaves.
- Flow color: Flow color (on/off), Flow hue influence, Flow color mode (angle|strength), Flow glow.
- UI: Show header, Show subheader, Show HUD.
- Interactions: Click mode (shockwave|gravity|spin|scatter), Drag mode (pull|push|spin|flow).

## URL Parameters
- Common: `hue`, `header`, `subheader`.
- Core: `count`, `vision`, `sep`, `maxSpeed`, `minSpeed`, `maxForce`, `alignW`, `cohesionW`, `separationW`, `wrap`.
- Visual: `trailAlpha`, `lineWidth`, `bgGradient`, `bgHueShift1/2/3`, `blend`, `shape`, `spawn`, `showHud`, `showHeader`, `showSubheader`.
- Quadtree: `qt`, `qtCap`.
- Flow: `flow`, `flowViz`, `flowVizStep`, `flowSpeed`, `flowScale`, `flowAmp`, `flowMode`, `flowAmpVar`, `flowAniso`, `flowOctaves`, `flowColor`, `flowHueScale`, `flowColorMode`, `flowGlow`.
- Vision viz: `visionViz` (off|one|all).
- Interactions: `clickMode`, `dragMode`.

Examples:
- `http://localhost:8080/demo?flow=true&flowViz=true&flowMode=turbulence&flowOctaves=4&flowAmpVar=0.6&flowAniso=0.8`
- `...?flowColor=true&flowHueScale=90&flowColorMode=angle&flowGlow=true`
- `...?visionViz=one&clickMode=spin&dragMode=flow`

## Behavior Notes
- Wrap on: boids wrap around screen edges; flow applies uniformly.
- Wrap off: flow attenuates near borders; soft wall repulsion nudges boids inward; velocities kept above `minSpeed` to avoid stalls.

## Linting (optional)
- If Node tooling available: `eslint --ext .html runs/**/*.html`

## Repo Structure
- `cmd/boids`: Go dual‑mode generator/server.
- `internal/generator`: Go template + generator (embedded template).
- `boidfactory*.sh`, `ollama-parallel.sh`, `pipe*.sh`: Shell pipelines for HTML generation via LLMs.
- `build-link-viewer.sh`, `build-runs-index.sh`: HTML link viewers.
- `runs/`: Generated artifacts (avoid large commits).
- `aider/`, `template.html`, `eslint.config.js`.

## Troubleshooting
- If the browser keeps an old version of the template, use a hard refresh or add a dummy query param to bust cache.
- If Go build fails due to environment permissions, ensure Go 1.22+ and access to the build cache.

